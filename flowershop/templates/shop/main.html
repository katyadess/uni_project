{% extends "shop/base.html" %}
{% block css_links %}
{% load static %}
<link rel="stylesheet" href="{% static "shop/css/main.css" %}">
{% endblock css_links %}
 
{% block content %}
    <main class="content">
        <form method="get" action="{% url "shop:main" %}" class="search-bar">
            <input type="text" name="q" placeholder="Пошук..." value="{{ request.GET.q|default:'' }}">
            <input type="hidden" name="flower_type" value="{{ request.GET.flower_type|default:'' }}">
            <input type="hidden" name="price_order" value="{{ request.GET.price_order|default:'' }}">
            <button type="submit">
                <img src="{% static 'shop/images/str.png' %}" alt="search">
            </button>
        </form>
        <div class="filt">
            <h3>Фільтри</h3>
            <form method="get" action="{% url "shop:main" %}" class="filters">
    
                <input type="hidden" name="q" value="{{ request.GET.q|default:'' }}">
                <select name="flower_type">
                    <option value="">Квіти</option>
                    {% for flower in flower_types %}
                        <option value="{{ flower.name }}" {% if request.GET.flower_type == flower.name %}selected{% endif %}>
                            {{ flower.name }}
                        </option>
                    {% endfor %}
                </select>
    
                <select name="price_order">
                    <option value="">Ціна</option>
                    <option value="asc" {% if request.GET.price_order == 'asc' %}selected{% endif %}>Від дешевших до дорожчих</option>
                    <option value="desc" {% if request.GET.price_order == 'desc' %}selected{% endif %}>Від дорожчих до дешевших</option>
                </select>
    
                <button type="submit" style="display:none;"></button>
                
            </form>
        </div>




        <div class="products">
            {% for bouquet in bouquets %}
                <a href="{% url "shop:pro_tovar" bouquet.id %}" class="card-link">
                    <div class="card">
                        <img src="{{ bouquet.image.url }}" alt="{{ bouquet.name }}">
                        <div class="flower-name">{{ bouquet.name }}</div>
                        <div class="price">
                            {% if bouquet.new_price %}
                                <span class="new-price">{{ bouquet.new_price|floatformat:0 }} грн</span>
                                <span class="discount-badge">-{{ bouquet.discount }}%</span>
                            {% else %}
                                <span class="new-price">{{ bouquet.price |floatformat:0 }} грн</span>
                            {% endif %}
                        </div>
                    </div>
                </a>
            {% endfor %}
            
        </div>
    </main>


    <div class="pagination">
        {% if bouquets.has_previous %}
            <a href="?page={{ bouquets.previous_page_number }}&q={{ request.GET.q }}&flower_type={{ request.GET.flower_type }}&price_order={{ request.GET.price_order }}" class="btn">Попередня сторінка</a>
        {% endif %}
        
        <span>Сторінка {{ bouquets.number }} з {{ bouquets.paginator.num_pages }}</span>
        
        {% if bouquets.has_next %}
            <a href="?page={{ bouquets.next_page_number }}&q={{ request.GET.q }}&flower_type={{ request.GET.flower_type }}&price_order={{ request.GET.price_order }}" class="btn">Дивитися ще</a>
        {% endif %}
    </div>

    <div class="consult">
        <p>Потрібна Консультація?</p>
        <p>Дзвони +38 (095) 432 1232</p>
    </div>

{% endblock content %}
     
{% block scripts %}
    <script src="{% static "shop/js/main.js" %}"></script>
{% endblock scripts %} 